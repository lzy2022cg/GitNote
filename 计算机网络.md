### 计算机网络体系结构

[![x219M9.png](https://s1.ax1x.com/2022/10/24/x219M9.png)](https://imgse.com/i/x219M9)

[![x21FVx.png](https://s1.ax1x.com/2022/10/24/x21FVx.png)](https://imgse.com/i/x21FVx)

#### **协议三要素**

- **语法：**定义所交换信息的格式。
- **语义：**定义收发双方所要完成的操作。
- **同步：**定义收发双方的时序关系。

[![x2Wfot.png](https://s1.ax1x.com/2022/10/24/x2Wfot.png)](https://imgse.com/i/x2Wfot)





### 数据通信基础知识

#### 数据通信模型

一个数据通信系统可以划分为三大部分，源系统（或发送端）、传输系统（或传输网络）和目的系统（或接收端）

![img](https://img-blog.csdnimg.cn/34f5018d274a4be8a4568d28dd1e3612.jpeg?x-oss-process=)

在数据通信系统中，通常将源计算机、目的计算机称作DTE，即数据终端设备。DTE使用的数据与通信线路传输的数据，从类型来看，大多数的时候是不一样的，需要进行变换。进行信号变换的设备称作DCE，即信号变换器。 在计算机网络发展的初期，DTE中使用的是数字信号，通信线路传输的是模拟信号。DCE负责信号变换，典型的设备是modem，即调制解调器。

![在这里插入图片描述](https://img-blog.csdnimg.cn/20200520132518775.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NzIzNzcz,size_16,color_FFFFFF,t_70)



源点：源点设备产生要传输的数据。例如计算机将键盘输入的信息转换成数字比特流发出

发送器：接收源点发出的二进制比特流转换成传输系统能够传输的数据。典型的发送器就是调制器 (modem)

接收器：接收传输系统传输来的信号并转换为终点设备能够处理的信息。典型的接收器就是解调器 (modem)

终点：终点设备接收接收器发送来的数字比特流并把信息通过屏幕显示器反馈给用户。

#### 调制与解调制

- 通常将数字信号变换为模拟信号称作调制；
- 将模拟信号变换为数字信号称作解调制。二者的变换方法是相似的，通常在同一个设备上实现。

#### 数据通信相关术语

信号：数据的电气或电磁的表现（就是将数据用另外一种形态表现出来，就好像水转换成冰，其实质还是水，仅仅是形态变了)。而数据是传送信息（如图片和文字等）的实体。

```ASN.1
数字信号/离散信号：代表消息的参数的取值是离散的。

模拟信号/连续信号： 代表消息的参数的取值是连续的。
```

注意：

无论数据或信号，都既可以是模拟的，也可以是数字的。“模拟的”就是连续变化的，而数字的表示取值仅允许是有限的离散值。



数据：传送消息的实体 ，通常是有意义的符号序列。

数据通信指在不同计算机之间传输表示信息的二进制数0、1序列的过程。 

信源：产生和发生数据的源头。

信宿：接收数据的终点。

 信道：信号的传输媒介。一般用来表示某一个方向传送信息的介质，因此一条通信线路往往包含一条发送信道和一条接收信道。

- 使用**数字信号**的信道称作**数字信道**；
- 使用**模拟信号**的信道称作**模拟信道**

![img](https://img-blog.csdnimg.cn/db200e255b8b49679b7c360d78569187.jpeg)

#### 数字信号和模拟信号的比较

**模拟信号与数字信号：**

- 由于模拟信号的波高和频率连续变化，因此在传输一定距离内，**信号衰减较小，信息保留相对完整**；

- 而数字信号是由多个频率的波形叠加而成，各个波形衰减速度不同，在传输的过程中，**信号变形比较严重，信息缺失较多**

  [![x2yrRJ.png](https://s1.ax1x.com/2022/10/24/x2yrRJ.png)](https://imgse.com/i/x2yrRJ)

#### 三种通信方式

**单工通信：**只有一个方向的通信而没有反方向的交互，仅需要一条信道。例如广播

![img](https://img-blog.csdnimg.cn/337c9b3a3e3145c19c7bb4f20eb44588.png)

**半双工通信/双向交替通信：**通信的双方都可以发送或接收信息，但任何一方都不能同时发送或接收，需要两条信道。例如对讲机。

![img](https://img-blog.csdnimg.cn/bdb9059bf88a4180b430a5973da6c623.png)

**全双工通信/双向同时通信：**通信的双方都可以同时发送和接收信息，需要两条信道。例如打电话。

![img](https://img-blog.csdnimg.cn/56b4ee7112334a4ebca6820a7b8f2716.png)

 基带信号（即基本频带信号）——来自信源的信号。像计算机输出的代表各种文字或图像文件的数据信号都属于基带信号。
基带信号往往包含有较多的低频成分，甚至有直流成分，而许多信道并不能传输这种低频分量或直流分量。因此必须对基带信号进行调制。

调制分为两大类：
基带调制：仅对基带信号的波形进行变换，使它能够与信道特性相适应。变换后的信号仍然是基带信号。把这种过程称为编码(coding)。
带通调制：使用载波(carrier）进行调制，把基带信号的频率范围搬移到较高的频段，并转换为模拟信号，这样就能够更好地在模拟信道中传输（即仅在一段频率范围内能够通过信道)
带通信号：经过载波调制后的信号。

#### 串行传输&并行传输

![img](https://img-blog.csdnimg.cn/41cc07218988424c8805b1dc72914718.jpeg)



### 

#### 同步传输&异步传输

![img](https://img-blog.csdnimg.cn/cf2939db87f34b34a650d2eaada26637.jpeg)





## 第三章 数据量链路层(二级标题)

### 3.1使用点对点信道的数据链路层(三级标题)

#### 数据链路和帧(四级标题)

点对点信道的数据链路层

**链路：**链路就是从一个节点到相邻节点的一段物理线路（有线或无线），而中间没有任何其他的交换节点。

**数据链路 (data link) ：**当需要在一条线路上传送数据时，除了必须有一条物理线路外，还必须有一些必要的通信协议来控制这些数据的传输，把实现这些协议的硬件和软件加到链路上，就构成了数据链路。

**帧：**帧是数据链路层对等实体之间在水平方向进行逻辑通信的协议数据单元PDU。

[![x2I1v8.png](https://s1.ax1x.com/2022/10/24/x2I1v8.png)](https://imgse.com/i/x2I1v8)

#### 三个基本问题(四级标题)

**封装成帧与透明传输**

[![x2IdCq.png](https://s1.ax1x.com/2022/10/24/x2IdCq.png)](https://imgse.com/i/x2IdCq)

应用层将待发送的应用层协议数据单元交付给运输层，运输层在应用层协议数据单元前添加运输层首部使之封装成运输层协议数据单元，然后运输层将运输层协议数据单元发交付给网络层，网络层在运输层协议数据单元前加上网络层首部使之封装成网络层协议数据单元，网络层将网络层协议数据单元交付给数据链路层，数据链路层在网络层协议数据单元上添加首部和尾部使之封装成帧。

[![x2O64e.png](https://s1.ax1x.com/2022/10/24/x2O64e.png)](https://imgse.com/i/x2O64e)

上图为发送方给接收方发送两个连续的帧，接收方根据帧定界符就能从数据比特流中识别出一个个的帧，但假如数据载荷部分出现一个与帧尾部取值相同的数据，那么接收方就会误以为数据载荷中的比特流为帧尾部，接收方就会出现帧定界错误的问题。

[![x2XnUO.png](https://s1.ax1x.com/2022/10/24/x2XnUO.png)](https://imgse.com/i/x2XnUO)

**差错检测**

发送方给接收方发送帧时，由于现实中的通信链路不是理想的，表示比特的信号在信道上传输时，不可避免地会出现失帧，或是误码。例如比特0变成比特1，比特1变成比特0.

[![x2jDYD.png](https://s1.ax1x.com/2022/10/24/x2jDYD.png)](https://imgse.com/i/x2jDYD)

差错检测措施：发送方的数据链路层采用某种检测技术，根据帧的内容计算出一个检错码，将检错码填入帧尾部，帧尾部中用来存放检错码的字段称为帧检验序列，英文缩写为CFS，下图为PPP帧尾部中的长度为2字节的帧检验序列。

[![x2jTpQ.png](https://s1.ax1x.com/2022/10/24/x2jTpQ.png)](https://imgse.com/i/x2jTpQ)

接收方的数据链路层从帧尾部取出检错码，采用与发送方相同的检错技术，就可通过检错码检测出帧在传输过程中是否出现误码。

**可靠传输**

若数据链路层向上层提供的时不可靠传输服务，则接收方的数据链路层丢弃有误码的帧即可，若数据链路层向上层提供的是可靠传输服务，数据链路层通过某种机制使发送方发送什么信息接收方就接收什么信息。例如接收方接收到有误码的帧后就通知发送方重新发送有误码的帧，发送方给接收方重新发送该帧。

[![x2vVAK.png](https://s1.ax1x.com/2022/10/24/x2vVAK.png)](https://imgse.com/i/x2vVAK)

### 3.2封装成帧(三级标题)

**帧：**是数据链路层对等实体之间在水平方向上进行逻辑通信的协议数据单元PDU。

**封装成帧：**封装成帧就是数据链路层将上层交付下来的协议数据单元添加帧头和帧尾使之成为帧。

[![x2xPPS.png](https://s1.ax1x.com/2022/10/24/x2xPPS.png)](https://imgse.com/i/x2xPPS)

将上层交付下来的协议数据单元封装成帧后，还要通过物理层将构成帧的比特流转换成电信号发送到传输媒体，即源点 (发送端) 将比特流发送给发送器，发送器将接收的比特流调制成可以被通信信道识别的电信号 (模拟信号) ，然后通信信道将电信号(模拟信号) 发送给接收器，接收器将电信号 (模拟信号) 转换成可以被终点(接收端)物理层识别的比特流，终点的物理层接收到比特流后将其转换为数字信号在计算机中传输。

[![x2xWi8.png](https://s1.ax1x.com/2022/10/24/x2xWi8.png)](https://imgse.com/i/x2xWi8)



如何从比特流中提取出一个个的帧

帧头和帧尾的作用之一就是帧定界，区分出一个个的帧

[![x2zkFK.png](https://s1.ax1x.com/2022/10/24/x2zkFK.png)](https://imgse.com/i/x2zkFK)

 [![x2zmyd.png](https://s1.ax1x.com/2022/10/24/x2zmyd.png)](https://imgse.com/i/x2zmyd)

但并不是所有帧都包含帧定界标志，下图中的帧头和帧尾不包含帧定界标志

[![x2zrfU.png](https://s1.ax1x.com/2022/10/24/x2zrfU.png)](https://imgse.com/i/x2zrfU)

上图不包含帧定界标志，那么物理层如何从比特流提取出一个个的以太网帧呢？

实际上，以太网的数据链路层封装好MAC帧后，将其交付给物理层，物理层会会在MAC帧前添加8字节的前导码，前导码中的前七个字节为前同步码，作用是使接收方的时钟同步，最后的1个字节为帧定界符，表明其后面跟着的是帧，然后将比特流发送给发送器 (调制器) 将其调制为能够被通信信道传输的电信号 (模拟信号)，发送器向通信信道发送电信号 (模拟信号) ，通信信道将接收的电信号发送给终点的接收器 (解调器) ，接收器将电信号转换为比特流发送给源点的物理层，物理层从比特流中取出一个个帧，去对上层服务。

[![xRSOv4.png](https://s1.ax1x.com/2022/10/24/xRSOv4.png)](https://imgse.com/i/xRSOv4)

以太网还规定了每次发送帧的时间间隔为96比特的发送时间，所以MAC并不需要帧结束界定符

[![xRppUx.png](https://s1.ax1x.com/2022/10/24/xRppUx.png)](https://imgse.com/i/xRppUx)



**透明传输：**透明传输是指数据链路层对上层交付的传输数据没有任何限制，就好像数据链路层不存在一样。



[![x2O64e.png](https://s1.ax1x.com/2022/10/24/x2O64e.png)](https://imgse.com/i/x2O64e)

上图为发送方给接收方发送两个连续的帧，接收方根据帧定界符就能从数据比特流中识别出一个个的帧，但假如数据载荷部分出现一个与帧尾部取值相同的数据，接收方在收到第一个帧定界标志时，会认为这是帧的开始，但接收方收到数据载荷中的与帧定界标志相同值的数据时会认为这是帧的结束，接收方就会出现帧定界错误的问题。

如上所述，如果不能解决帧定界问题，就会导致数据链路层封装帧时不能添加帧定界符，数据链路层上层交付的传输数据受到限制，不能成为透明传输。

一个较好的解决方案是，在封装帧时给帧头定界符和帧尾定界符加上转义字符，这样终点的物理层在接收帧时就可以不受到影响，同时接收到一个帧定界符时也会剔除转义字符，当遇到第二个转义字符时既是帧的结尾。

以上介绍的是面向字节的物理链路使用字节填充（或称为字符填充）的方法实现透明传输。

对于面向比特的物理链路使用比特填充的方法实现透明传输。

[![xRPpan.png](https://s1.ax1x.com/2022/10/24/xRPpan.png)](https://imgse.com/i/xRPpan)

帧的数据部分出现了两个帧定界标志，但他们是数据，零比特填充方法是在传输前对帧数据部分先进性扫描，如果出现6个连续的1，那就在每五个连续1的后面添加一个0，这样就保证帧定界，在整个帧中的唯一性，也就可以实现透明传输。接收方只需要将帧数据部分中每五个连续1后面的0剔除即可。

[![xRPtZd.png](https://s1.ax1x.com/2022/10/24/xRPtZd.png)](https://imgse.com/i/xRPtZd)
